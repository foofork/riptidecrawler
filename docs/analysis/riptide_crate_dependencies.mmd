%% Riptide Crate Dependencies - Mermaid Graph
%% Generated: 2025-11-03
%% Total Crates: 26 workspace members
%% View at: https://mermaid.live or use Mermaid CLI

graph TB
    %% ========================================
    %% FOUNDATION LAYER (Leaf Crates - No Dependencies)
    %% ========================================

    types["ğŸŒ³ riptide-types<br/>Foundation: Shared Types<br/>24 dependents"]
    stealth["ğŸ“¦ riptide-stealth<br/>Anti-Detection<br/>4 dependents"]
    security["ğŸ“¦ riptide-security<br/>Security Middleware<br/>0 dependents"]
    persistence["ğŸ“¦ riptide-persistence<br/>Redis Persistence<br/>1 dependent"]
    search["ğŸ“¦ riptide-search<br/>Search Providers<br/>2 dependents"]
    performance["ğŸ“¦ riptide-performance<br/>Profiling<br/>1 dependent"]
    test-utils["ğŸ“¦ riptide-test-utils<br/>Test Utilities<br/>Dev only"]

    %% ========================================
    %% CONFIGURATION LAYER
    %% ========================================

    config["riptide-config<br/>Configuration<br/>3 dependents"]
    config --> types

    %% ========================================
    %% CORE INFRASTRUCTURE LAYER
    %% ========================================

    monitoring["ğŸŒ³ riptide-monitoring<br/>Observability<br/>4 dependents"]
    monitoring --> types

    fetch["ğŸŒ³ riptide-fetch<br/>HTTP/Network<br/>4 dependents"]
    fetch --> types
    fetch --> config

    events["ğŸ”— riptide-events<br/>Event Bus<br/>7 dependents"]
    events --> types
    events --> monitoring

    %% ========================================
    %% BROWSER AUTOMATION LAYER
    %% ========================================

    browser-abs["riptide-browser-abstraction<br/>Browser Abstraction<br/>1 dependent"]
    browser-abs --> types

    browser["riptide-browser<br/>Browser Pool<br/>3 dependents"]
    browser --> browser-abs
    browser --> stealth

    headless["riptide-headless<br/>Headless API<br/>1 dependent"]
    headless --> browser
    headless --> stealth

    %% ========================================
    %% EXTRACTION & PROCESSING LAYER
    %% ========================================

    extraction["ğŸ”— riptide-extraction<br/>HTML Extraction<br/>9 dependents<br/>âš ï¸ HIGH COUPLING"]
    extraction --> types

    pdf["riptide-pdf<br/>PDF Processing<br/>3 dependents"]
    pdf --> types

    pool["riptide-pool<br/>Instance Pooling<br/>2 dependents"]
    pool --> types
    pool --> events
    pool -.->|optional| extraction

    %% ========================================
    %% SPIDER & CRAWLING LAYER
    %% ========================================

    spider["ğŸ”— riptide-spider<br/>Web Crawler<br/>2 dependents"]
    spider --> types
    spider --> config
    spider --> fetch

    %% ========================================
    %% RELIABILITY & CACHING LAYER
    %% ========================================

    reliability["ğŸ”„ riptide-reliability<br/>Circuit Breakers<br/>3 dependents<br/>âœ… Circular resolved"]
    reliability --> types
    reliability --> fetch
    reliability -.->|optional| events
    reliability -.->|optional| monitoring
    reliability -.->|optional| pool

    cache["riptide-cache<br/>Caching System<br/>3 dependents"]
    cache --> types
    cache --> pool
    cache --> events
    cache --> extraction

    %% ========================================
    %% INTELLIGENCE LAYER
    %% ========================================

    intelligence["riptide-intelligence<br/>LLM Abstraction<br/>1 dependent"]
    intelligence --> reliability
    intelligence --> types
    intelligence --> events

    %% ========================================
    %% WORKERS & BACKGROUND JOBS
    %% ========================================

    workers["riptide-workers<br/>Job Processing<br/>1 dependent"]
    workers --> types
    workers --> reliability
    workers --> extraction
    workers --> cache
    workers --> pdf

    %% ========================================
    %% STREAMING LAYER
    %% ========================================

    streaming["riptide-streaming<br/>SSE/WebSocket<br/>0 dependents"]
    streaming --> extraction

    %% ========================================
    %% HIGH-LEVEL API LAYER
    %% ========================================

    facade["ğŸ”— riptide-facade<br/>High-Level API<br/>1 dependent<br/>10 dependencies"]
    facade --> types
    facade --> fetch
    facade --> extraction
    facade --> pdf
    facade --> cache
    facade --> browser
    facade --> stealth
    facade -.->|optional| monitoring
    facade --> spider
    facade --> search

    api["ğŸŒ³ riptide-api<br/>REST API Server<br/>ROOT CRATE<br/>16+ dependencies"]
    api --> types
    api --> spider
    api --> fetch
    api --> monitoring
    api --> events
    api --> extraction
    api --> search
    api --> config
    api --> intelligence
    api --> workers
    api --> browser
    api --> headless
    api --> performance
    api --> persistence
    api --> facade
    api --> pdf
    api --> stealth
    api --> cache
    api --> reliability

    cli["ğŸ“¦ riptide-cli<br/>Thin CLI Client<br/>STANDALONE<br/>0 internal deps"]
    cli -.->|HTTP| api

    %% ========================================
    %% CRITICAL EXTERNAL DEPENDENCIES
    %% ========================================

    tokio[("âš¡ tokio<br/>Async Runtime<br/>26/26 crates")]
    serde[("âš¡ serde<br/>Serialization<br/>26/26 crates")]
    reqwest[("âš¡ reqwest<br/>HTTP Client<br/>10 crates")]
    spider-chrome[("âš¡ spider_chrome<br/>Browser CDP<br/>5 crates")]
    redis[("âš¡ redis<br/>Cache/Queue<br/>4 crates")]
    axum[("âš¡ axum<br/>Web Framework<br/>5 crates")]
    wasmtime[("âš¡ wasmtime<br/>WASM Runtime<br/>5 crates")]
    opentel[("âš¡ opentelemetry<br/>Observability<br/>5 crates")]

    types -.->|uses| tokio
    types -.->|uses| serde
    fetch -.->|uses| reqwest
    browser -.->|uses| spider-chrome
    cache -.->|uses| redis
    api -.->|uses| axum
    extraction -.->|uses| wasmtime
    monitoring -.->|uses| opentel

    %% ========================================
    %% STYLING
    %% ========================================

    classDef foundation fill:#e1f5e1,stroke:#4caf50,stroke-width:3px
    classDef infrastructure fill:#e3f2fd,stroke:#2196f3,stroke-width:2px
    classDef browser fill:#fff3e0,stroke:#ff9800,stroke-width:2px
    classDef extraction fill:#f3e5f5,stroke:#9c27b0,stroke-width:2px
    classDef api fill:#ffebee,stroke:#f44336,stroke-width:3px
    classDef external fill:#fafafa,stroke:#607d8b,stroke-width:1px,stroke-dasharray: 5 5
    classDef highCoupling fill:#fff9c4,stroke:#fbc02d,stroke-width:3px

    class types,stealth,security,persistence,search,performance,test-utils,config foundation
    class monitoring,fetch,events infrastructure
    class browser-abs,browser,headless browser
    class extraction,pdf,pool,spider extraction
    class reliability,cache,intelligence,workers,streaming extraction
    class facade,api,cli api
    class tokio,serde,reqwest,spider-chrome,redis,axum,wasmtime,opentel external
    class extraction,spider,facade,api,events highCoupling

    %% ========================================
    %% NOTES
    %% ========================================

    note1["LEGEND:<br/>ğŸŒ³ Root (many dependents)<br/>ğŸ”— High coupling<br/>ğŸ“¦ Leaf (no deps)<br/>ğŸ”„ Circular resolved<br/>âš¡ External dependency"]

    note2["KEY INSIGHTS:<br/>âœ… Clean foundation layer<br/>âœ… Circular deps resolved<br/>âš ï¸ Extraction high coupling<br/>âš ï¸ API depends on 16+ crates<br/>âœ… Thin CLI properly separated"]
