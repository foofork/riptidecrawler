# Stress Test Configuration for EventMesh/RipTide
# Tests system under heavy load

concurrency: 50
base: 'http://localhost:8080'
iterations: 500
rampup: 10

plan:
  # High concurrency render tests
  - name: Concurrent renders
    request:
      url: /api/v1/render
      method: POST
      body: |
        {
          "url": "https://example.com",
          "wait_condition": "load",
          "screenshot_mode": "viewport",
          "viewport": {"width": 1920, "height": 1080},
          "stealth_level": "medium",
          "javascript_enabled": true,
          "extra_timeout": 5000
        }
      headers:
        Content-Type: 'application/json'

  - name: Concurrent extractions
    request:
      url: /api/v1/extract
      method: POST
      body: |
        {
          "url": "https://example.com",
          "mode": "auto",
          "selectors": ["h1", "p", "a", "img"],
          "wait_condition": "load"
        }
      headers:
        Content-Type: 'application/json'

assertions:
  - 'status == 200 || status == 429'
  - 'response_time < 30000'
